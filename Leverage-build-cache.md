## Leverage build cache

เมื่อสร้าง image ทำตามขั้นตอนตามคำแนะนำของ **Dockerfile** เมื่อทำงานตามคำสั่งไปแต่ละคำสั่ง หาก Docker พบ image ที่มีใน cache ก็จะนำมาใช้ซ้ำแทนที่จะสร้าง image ใหม่

ซึ่งหากไม่ต้องการใช้ cache สามารถใช้ **--no-cache=true** วึ่งอยู่ในตัวเลือกของคำสั่ง docker build อย่างไรก็ตาม หากต้องการที่จะใช้ cache ก็จะต้องทำความเข้าใจใน image ที่จะนำมาใช้ซ้ำ โดยทำตามดังนี้ :

- เริ่มต้นที่ parent image ที่มีใน cache เพื่อที่จะนำมาเปรียบเทียบว่า child images ทั้งหมดที่มี ว่ามี image ไหนบ้างที่ใช้คำสั่งเดียวกัน มิเช่นนั้น cache จะไม่ถูกต้อง
- ส่วนมากจะเปรียบเทียบจาก Dockerfile กับ child images แต่ยย่างไรก็ตาม ก็ต้องมีการศึกษาและตรวจสอบเพิ่มเติม
- สำหรับคำสั่ง **ADD** และ **COPY** แต่ละไฟล์ใน image จะถูกตรวจสอบและประมวลผล โดยเวลาที่แก้ไขไฟล์ ส่วนการเข้าถึงครั้งล่าสุดของไฟล์จะไม่ถูกนำมาตรวจสอบ จะตรวจสอบและเปรียบเทียบแค่ไฟล์ที่มีใน image ซึ่งหากมีการเปลี่ยนแปลงอะไรในไฟล์เช่นเนื้อหาและ metadata แสดงว่า cache นั้นไม่ถูกต้อง
- นอกจากคำสั่ง **ADD** และ **COPY** คำสั่งที่ตรวจสอบ cache จะไม่ตรวจสอบไฟล์ที่อยู่ใน container เช่น คำสั่ง RUN apt-get -y update คำสั่งที่ใช้กับ คcontainer จะไม่ถูกตรวจสอบมีการเข้า cache หรือไม่

เมื่อ cache ไม่ถูกต้อง Dockerfile จะสร้าง image ใหม่โดยไม่ใช้ cache
